## Amazon ELB (Elastic Load Balancer)

### Amazon ELB 구성요소

**1. 로드 밸런서 (Load Balancer)**

- **역할:**

  - 로드 밸런서는 클라이언트로부터 들어오는 모든 트래픽의 **단일 접점(Single Point of Contact)** 역할을 합니다.

  - 즉, 외부에서 애플리케이션으로 들어오는 모든 요청은 먼저 이 로드 밸런서를 통과하게 됩니다. 로드 밸런서는 수신된 트래픽을 미리 정의된 규칙에 따라 여러 백엔드 인스턴스(서버) 또는 기타 대상에 분산하여 전달합니다.

- **주요 기능:**

  - 트래픽 분산: 들어오는 요청을 여러 대상에 효율적으로 분배하여 특정 서버의 과부하를 방지합니다.

  - **고가용성:** 대상 인스턴스 중 일부가 실패하더라도, 로드 밸런서는 자동으로 해당 인스턴스에 트래픽을 보내지 않고 정상적인 인스턴스로만 트래픽을 라우팅하여 서비스 중단을 방지합니다.

  - 확장성: 애플리케이션의 트래픽 변화에 따라 로드 밸런서 자체의 용량도 자동으로 확장되거나 축소됩니다.

  - **상태 확인 (Health Check):** 등록된 대상들의 상태를 주기적으로 확인하여, 비정상적인 대상에게는 트래픽을 보내지 않습니다.

- **종류:** AWS ELB는 크게 세 가지 유형의 로드 밸런서를 제공하며, 각각 다른 계층에서 작동합니다.

  - Application Load Balancer (ALB): HTTP/HTTPS 트래픽(OSI 모델의 7계층)을 로드 밸런싱합니다. URL 경로, 호스트 헤더, 쿼리 문자열 등 애플리케이션 계층 정보를 기반으로 트래픽을 라우팅할 수 있어 마이크로서비스나 컨테이너 기반 애플리케이션에 적합합니다.

  - Network Load Balancer (NLB): TCP/UDP/TLS 트래픽(OSI 모델의 4계층)을 로드 밸런싱합니다. 초당 수백만 건의 요청을 처리할 수 있는 극도로 높은 성능과 낮은 지연 시간을 제공하며, 고정 IP 주소를 가질 수 있습니다.

  - Gateway Load Balancer (GWLB): 가상 어플라이언스(방화벽, 침입 방지 시스템 등)를 위한 로드 밸런서로, 중앙 집중식 관리 및 스케일링을 지원합니다.

  - Classic Load Balancer (CLB): 이전 세대 로드 밸런서로, 현재는 ALB나 NLB 사용이 권장됩니다.

**2. 대상 그룹 (Target Group)**

- **역할:**

  - 대상 그룹은 로드 밸런서가 트래픽을 라우팅할 **하나 이상의 등록된 대상(Targets) 집합**입니다.

  - 이 대상들은 주로 EC2 인스턴스이지만, 컨테이너, IP 주소, AWS Lambda 함수 등도 대상이 될 수 있습니다.

- **주요 기능:**

  - 대상 등록: 로드 밸런서로부터 트래픽을 받을 EC2 인스턴스나 IP 주소 등을 이 그룹에 등록합니다.

  - 상태 확인 (Health Check) 설정: 각 대상 그룹별로 상태 확인 프로토콜, 포트, 경로, 임계값 등을 세밀하게 설정할 수 있습니다. 로드 밸런서는 이 설정을 기반으로 대상 그룹에 등록된 대상들의 상태를 주기적으로 점검합니다.

  - 라우팅 규칙의 목적지: 리스너 규칙에서 특정 조건에 부합하는 트래픽을 특정 대상 그룹으로 전달하도록 지정합니다.

- **특징:**

  - 하나의 로드 밸런서는 여러 개의 대상 그룹을 가질 수 있습니다.

  - 하나의 대상(예: EC2 인스턴스)은 여러 대상 그룹에 동시에 등록될 수 있습니다.

**3. 리스너 (Listener)**

- **역할:**

  - 리스너는 로드 밸런서에서 **들어오는 연결 요청을 확인하는 프로세스**입니다. 특정 **프로토콜 (Protocol)** 및 **포트 (Port)**에서 클라이언트의 요청을 "수신 대기(Listen)"하며, 수신된 요청을 처리하기 위한 규칙(Rules)을 정의합니다.

- **주요 기능:**

  - 프로토콜 및 포트 정의: 로드 밸런서가 어떤 프로토콜(HTTP, HTTPS, TCP, TLS, UDP)과 어떤 포트에서 클라이언트 요청을 받을지 지정합니다.

  - **규칙 정의:** 리스너는 하나 이상의 규칙을 가집니다.

    - 기본 규칙 (Default Rule): 모든 리스너는 반드시 하나의 기본 규칙을 가져야 합니다. 이 규칙은 다른 어떤 규칙의 조건에도 부합하지 않는 모든 트래픽을 특정 대상 그룹으로 전달하는 역할을 합니다.

    - 추가 규칙 (Optional Rules - ALB의 경우): ALB 리스너는 기본 규칙 외에 여러 개의 추가 규칙을 가질 수 있습니다. 이 규칙들은 특정 조건(예: 요청 URL 경로, 호스트 헤더, HTTP 헤더 등)에 따라 트래픽을 다른 대상 그룹으로 라우팅할 수 있도록 합니다. 예를 들어, `/api` 경로로 오는 요청은 A 대상 그룹으로, `/images` 경로로 오는 요청은 B 대상 그룹으로 보낼 수 있습니다.

### AWS ELB는 Managed Service이다

- AWS가 로드 밸런서 자체의 인프라(서버, 네트워킹, 소프트웨어)를 관리한다.

- 사용자는 로드 밸런서의 인스턴스를 프로비저닝하거나, 패치하거나, 업그레이드하거나, 용량을 계획할 필요가 없다.
